/* Copyright 2019 Brian Hackett. Released under the MIT license. */

const { generateBjerrumData } = require("../carbonate");
const { Terms } = require("../units");
const { expect } = require("./utils");

const { Celsius, Salinity, pH } = Terms;

// https://coral.wiki/wiki/index.php?title=Carbonate-Script
//
// Compute Bjerrum plot data for carbonate concentrations as a function of pH.
// Note: these values are a little different from what is used in the plot on
// the wiki.
expect(generateBjerrumData(Celsius(28), Salinity(35), pH(4), pH(10), 20), {
  pH: [
    4,4.3,4.6,4.9,5.2,5.5,5.8,6.1,6.4,6.7,7,7.300000000000001,7.6,7.9,8.2,8.5,
    8.8,9.1,9.4,9.7,10
  ],
  CO2: [
    0.984521075526212,0.969583696419006,0.9410933224090265,0.8889700081106523,
    0.8004947579655667,0.667836965822745,0.5018130225484696,0.3353017888106607,
    0.20155084443942506,0.11199784775270286,0.05911113157120767,0.030168841399686053,
    0.014996011673134002,0.0072358410873917985,0.0033421465853907114,0.001442230947745387,
    0.0005649467721451164,0.00019708664968350493,0.00006147748027210752,
    0.000017571226527866345,0.000004741199864460002
  ],
  HCO3: [
    0.015478732301200738,0.030415550135701457,0.058903766209517955,0.11101904341693042,
    0.19946599336739915,0.33203267642187734,0.4977970279702201,0.6636609161765231,
    0.7959668739977577,0.8825108405413282,0.9293507313926656,0.9463875181866062,
    0.9386120851525607,0.9036482091746433,0.8327906985033544,0.7170429702231562,
    0.5604255200611997,0.39009248044595485,0.2427875602781465,0.1384562132541083,
    0.07454158708511233
  ],
  CO3: [
    1.9217258716646182e-7,7.534452924028192e-7,0.000002911381455470726,
    0.000010948472417309969,0.00003924866703411113,0.00013035775537761953,
    0.0003899494813103613,0.001037295012816208,0.0024822815628172544,0.00549131170596871,
    0.011538137036126519,0.02344364041370783,0.04639190317430533,0.08911594973796506,
    0.1638671549112548,0.2815147988290984,0.43900953316665525,0.6097104329043617,
    0.7571509622415814,0.8615262155193639,0.9254536717150232
  ]
});
