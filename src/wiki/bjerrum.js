/* Copyright 2019 Brian Hackett. Released under the MIT license. */

const { generateBjerrumData } = require("../carbonate");
const { Terms } = require("../units");
const { expect } = require("./utils");

const { Celsius, Salinity, pH } = Terms;

// https://coral.wiki/wiki/index.php?title=Carbonate-Script
//
// Compute Bjerrum plot data for carbonate concentrations as a function of pH.
// Note: these values are a little different from what is used in the plot on
// the wiki.
expect(generateBjerrumData(Celsius(28), Salinity(35), pH(4), pH(10), 20), {
  pH: [
    4,4.3,4.6,4.9,5.2,5.5,5.8,6.1,6.4,6.7,7,7.300000000000001,7.6,7.9,8.2,8.5,
    8.8,9.1,9.4,9.7,10
  ],
  CO2: [
    0.9848929113223638,0.9703035442338056,0.9424474474049338,0.891384151925819,
    0.8044097522161088,0.6732937689825851,0.5079902761908672,0.34083588459248054,
    0.20556625990972835,0.11449255544704125,0.06051651030928534,0.03091742232615679,
    0.015382550549483636,0.00743154568606748,0.0034391583859829785,0.0014884530924744461,
    0.0005853296203831677,0.00020506228393772784,0.00006419990444741284,
    0.000018397073776593477,0.0000049719564760471044
  ],
  HCO3: [
    0.015106905695918398,0.029695738093692244,0.05754977751299741,0.10860539886081816,
    0.19555270763283575,0.32658114081824335,0.49163399535304675,0.6581605076686636,
    0.7920239982238148,0.8801643121327211,0.928240221630772,0.9462149050013124,
    0.9393227857349756,0.9054524714670029,0.8360623830135551,0.7219741684663057,
    0.5664831658300018,0.3959791295494598,0.2473551108453106,0.14142795330758545,
    0.0762629893507985
  ],
  CO3: [
    1.8298171781124045e-7,7.176725022047829e-7,0.0000027750820686371167,
    0.000010449213362810687,0.00003754015105557992,0.00012509019917162685,
    0.0003757284560858526,0.0010036077388559871,0.0024097418664568142,
    0.005343132420237728,0.011243268059942664,0.022867672672530683,0.04529466371554056,
    0.08711598284692947,0.16049845860046186,0.27653737844121984,0.43293150454961504,
    0.6038158081666023,0.752580689250242,0.8585536496186379,0.9237320386927254
  ]
});
